"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

function resFixture(url, method) {
  if (/\/status$/.test(url)) {
    return [200, {
      status: 0,
      value: {
        foo: 'bar'
      }
    }];
  }

  if (/\/element\/bad\/text$/.test(url)) {
    return [500, {
      status: 11,
      value: {
        message: 'Invisible element'
      }
    }];
  }

  if (/\/element\/200\/text$/.test(url)) {
    return [200, {
      status: 11,
      value: {
        message: 'Invisible element'
      }
    }];
  }

  if (/\/element\/200\/value$/.test(url)) {
    return [200, {
      status: 0,
      sessionId: 'innersessionid',
      value: 'foobar'
    }];
  }

  if (/\/session$/.test(url) && method === 'POST') {
    return [200, {
      status: 0,
      sessionId: '123',
      value: {
        browserName: 'boo'
      }
    }];
  }

  if (/\/nochrome$/.test(url)) {
    return [100, {
      status: 0,
      value: {
        message: 'chrome not reachable'
      }
    }];
  }

  throw new Error("Can't handle url " + url);
}

async function request(opts) {
  const {
    url,
    method,
    json
  } = opts;

  if (/badurl$/.test(url)) {
    throw new Error('noworky');
  }

  const [status, data] = resFixture(url, method, json);
  return {
    status,
    headers: {
      'content-type': 'application/json; charset=utf-8'
    },
    data
  };
}

var _default = request;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Rlc3QvdW5pdC9qc29ud3AtcHJveHkvbW9jay1yZXF1ZXN0LmpzIl0sIm5hbWVzIjpbInJlc0ZpeHR1cmUiLCJ1cmwiLCJtZXRob2QiLCJ0ZXN0Iiwic3RhdHVzIiwidmFsdWUiLCJmb28iLCJtZXNzYWdlIiwic2Vzc2lvbklkIiwiYnJvd3Nlck5hbWUiLCJFcnJvciIsInJlcXVlc3QiLCJvcHRzIiwianNvbiIsImRhdGEiLCJoZWFkZXJzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSxTQUFTQSxVQUFULENBQXFCQyxHQUFyQixFQUEwQkMsTUFBMUIsRUFBa0M7QUFDaEMsTUFBSSxZQUFZQyxJQUFaLENBQWlCRixHQUFqQixDQUFKLEVBQTJCO0FBQ3pCLFdBQU8sQ0FBQyxHQUFELEVBQU07QUFBQ0csTUFBQUEsTUFBTSxFQUFFLENBQVQ7QUFBWUMsTUFBQUEsS0FBSyxFQUFFO0FBQUNDLFFBQUFBLEdBQUcsRUFBRTtBQUFOO0FBQW5CLEtBQU4sQ0FBUDtBQUNEOztBQUNELE1BQUksd0JBQXdCSCxJQUF4QixDQUE2QkYsR0FBN0IsQ0FBSixFQUF1QztBQUNyQyxXQUFPLENBQUMsR0FBRCxFQUFNO0FBQUNHLE1BQUFBLE1BQU0sRUFBRSxFQUFUO0FBQWFDLE1BQUFBLEtBQUssRUFBRTtBQUFDRSxRQUFBQSxPQUFPLEVBQUU7QUFBVjtBQUFwQixLQUFOLENBQVA7QUFDRDs7QUFDRCxNQUFJLHdCQUF3QkosSUFBeEIsQ0FBNkJGLEdBQTdCLENBQUosRUFBdUM7QUFDckMsV0FBTyxDQUFDLEdBQUQsRUFBTTtBQUFDRyxNQUFBQSxNQUFNLEVBQUUsRUFBVDtBQUFhQyxNQUFBQSxLQUFLLEVBQUU7QUFBQ0UsUUFBQUEsT0FBTyxFQUFFO0FBQVY7QUFBcEIsS0FBTixDQUFQO0FBQ0Q7O0FBQ0QsTUFBSSx5QkFBeUJKLElBQXpCLENBQThCRixHQUE5QixDQUFKLEVBQXdDO0FBQ3RDLFdBQU8sQ0FBQyxHQUFELEVBQU07QUFBQ0csTUFBQUEsTUFBTSxFQUFFLENBQVQ7QUFBWUksTUFBQUEsU0FBUyxFQUFFLGdCQUF2QjtBQUF5Q0gsTUFBQUEsS0FBSyxFQUFFO0FBQWhELEtBQU4sQ0FBUDtBQUNEOztBQUNELE1BQUksYUFBYUYsSUFBYixDQUFrQkYsR0FBbEIsS0FBMEJDLE1BQU0sS0FBSyxNQUF6QyxFQUFpRDtBQUMvQyxXQUFPLENBQUMsR0FBRCxFQUFNO0FBQUNFLE1BQUFBLE1BQU0sRUFBRSxDQUFUO0FBQVlJLE1BQUFBLFNBQVMsRUFBRSxLQUF2QjtBQUE4QkgsTUFBQUEsS0FBSyxFQUFFO0FBQUNJLFFBQUFBLFdBQVcsRUFBRTtBQUFkO0FBQXJDLEtBQU4sQ0FBUDtBQUNEOztBQUNELE1BQUksY0FBY04sSUFBZCxDQUFtQkYsR0FBbkIsQ0FBSixFQUE2QjtBQUMzQixXQUFPLENBQUMsR0FBRCxFQUFNO0FBQUNHLE1BQUFBLE1BQU0sRUFBRSxDQUFUO0FBQVlDLE1BQUFBLEtBQUssRUFBRTtBQUFDRSxRQUFBQSxPQUFPLEVBQUU7QUFBVjtBQUFuQixLQUFOLENBQVA7QUFDRDs7QUFDRCxRQUFNLElBQUlHLEtBQUosQ0FBVSxzQkFBc0JULEdBQWhDLENBQU47QUFDRDs7QUFFRCxlQUFlVSxPQUFmLENBQXdCQyxJQUF4QixFQUE4QjtBQUM1QixRQUFNO0FBQUNYLElBQUFBLEdBQUQ7QUFBTUMsSUFBQUEsTUFBTjtBQUFjVyxJQUFBQTtBQUFkLE1BQXNCRCxJQUE1Qjs7QUFDQSxNQUFJLFVBQVVULElBQVYsQ0FBZUYsR0FBZixDQUFKLEVBQXlCO0FBQ3ZCLFVBQU0sSUFBSVMsS0FBSixDQUFVLFNBQVYsQ0FBTjtBQUNEOztBQUVELFFBQU0sQ0FBQ04sTUFBRCxFQUFTVSxJQUFULElBQWlCZCxVQUFVLENBQUNDLEdBQUQsRUFBTUMsTUFBTixFQUFjVyxJQUFkLENBQWpDO0FBQ0EsU0FBTztBQUNMVCxJQUFBQSxNQURLO0FBRUxXLElBQUFBLE9BQU8sRUFBRTtBQUFDLHNCQUFnQjtBQUFqQixLQUZKO0FBR0xELElBQUFBO0FBSEssR0FBUDtBQUtEOztlQUVjSCxPIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gcmVzRml4dHVyZSAodXJsLCBtZXRob2QpIHtcbiAgaWYgKC9cXC9zdGF0dXMkLy50ZXN0KHVybCkpIHtcbiAgICByZXR1cm4gWzIwMCwge3N0YXR1czogMCwgdmFsdWU6IHtmb286ICdiYXInfX1dO1xuICB9XG4gIGlmICgvXFwvZWxlbWVudFxcL2JhZFxcL3RleHQkLy50ZXN0KHVybCkpIHtcbiAgICByZXR1cm4gWzUwMCwge3N0YXR1czogMTEsIHZhbHVlOiB7bWVzc2FnZTogJ0ludmlzaWJsZSBlbGVtZW50J319XTtcbiAgfVxuICBpZiAoL1xcL2VsZW1lbnRcXC8yMDBcXC90ZXh0JC8udGVzdCh1cmwpKSB7XG4gICAgcmV0dXJuIFsyMDAsIHtzdGF0dXM6IDExLCB2YWx1ZToge21lc3NhZ2U6ICdJbnZpc2libGUgZWxlbWVudCd9fV07XG4gIH1cbiAgaWYgKC9cXC9lbGVtZW50XFwvMjAwXFwvdmFsdWUkLy50ZXN0KHVybCkpIHtcbiAgICByZXR1cm4gWzIwMCwge3N0YXR1czogMCwgc2Vzc2lvbklkOiAnaW5uZXJzZXNzaW9uaWQnLCB2YWx1ZTogJ2Zvb2Jhcid9XTtcbiAgfVxuICBpZiAoL1xcL3Nlc3Npb24kLy50ZXN0KHVybCkgJiYgbWV0aG9kID09PSAnUE9TVCcpIHtcbiAgICByZXR1cm4gWzIwMCwge3N0YXR1czogMCwgc2Vzc2lvbklkOiAnMTIzJywgdmFsdWU6IHticm93c2VyTmFtZTogJ2Jvbyd9fV07XG4gIH1cbiAgaWYgKC9cXC9ub2Nocm9tZSQvLnRlc3QodXJsKSkge1xuICAgIHJldHVybiBbMTAwLCB7c3RhdHVzOiAwLCB2YWx1ZToge21lc3NhZ2U6ICdjaHJvbWUgbm90IHJlYWNoYWJsZSd9fV07XG4gIH1cbiAgdGhyb3cgbmV3IEVycm9yKFwiQ2FuJ3QgaGFuZGxlIHVybCBcIiArIHVybCk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJlcXVlc3QgKG9wdHMpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSByZXF1aXJlLWF3YWl0XG4gIGNvbnN0IHt1cmwsIG1ldGhvZCwganNvbn0gPSBvcHRzO1xuICBpZiAoL2JhZHVybCQvLnRlc3QodXJsKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignbm93b3JreScpO1xuICB9XG5cbiAgY29uc3QgW3N0YXR1cywgZGF0YV0gPSByZXNGaXh0dXJlKHVybCwgbWV0aG9kLCBqc29uKTtcbiAgcmV0dXJuIHtcbiAgICBzdGF0dXMsXG4gICAgaGVhZGVyczogeydjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCd9LFxuICAgIGRhdGEsXG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IHJlcXVlc3Q7XG4iXX0=